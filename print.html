<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Nixago Extensions</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="extensions/index.html"><strong aria-hidden="true">2.</strong> Extensions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="extensions/conform.html"><strong aria-hidden="true">2.1.</strong> Conform</a></li><li class="chapter-item expanded "><a href="extensions/ghsettings.html"><strong aria-hidden="true">2.2.</strong> Github Settings</a></li><li class="chapter-item expanded "><a href="extensions/just.html"><strong aria-hidden="true">2.3.</strong> Just</a></li><li class="chapter-item expanded "><a href="extensions/lefthook.html"><strong aria-hidden="true">2.4.</strong> Lefthook</a></li><li class="chapter-item expanded "><a href="extensions/pre-commit.html"><strong aria-hidden="true">2.5.</strong> Pre-commit</a></li><li class="chapter-item expanded "><a href="extensions/prettier.html"><strong aria-hidden="true">2.6.</strong> Prettier</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Nixago Extensions</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Nixago Extensions is a <a href="https://nixos.wiki/wiki/Flakes">flake</a> library which provides extensions for
<a href="https://github.com/nix-community/nixago">Nixago</a>. The extensions are designed to quickly generate configuration files
for common development tools. They abstract away the difficulty of templating by
providing a clean interface.</p>
<p>Don't see the tool you're looking for? <a href="https://github.com/nix-community/nixago-extensions/issues/new">Raise an issue</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="extensions"><a class="header" href="#extensions">Extensions</a></h1>
<p>This chapter contains documentation for each of the provided extensions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conform"><a class="header" href="#conform">Conform</a></h1>
<p>This extension generates the <code>.conform.yaml</code> file for configuring <a href="https://github.com/siderolabs/conform">Conform</a>.
It takes a simplified version of the configuration file:</p>
<ul>
<li>The top-level <code>policies</code> entry is removed</li>
<li>The <code>type</code> and <code>spec</code> sections of the policy are removed</li>
</ul>
<p>Instead, the plugin takes a set with the <code>commit</code> and <code>license</code> attributes (the
two valid policy types), and the value is what would typically get placed under
<code>spec</code>. This change reduces the overall nesting of the input.</p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<p>Example input:</p>
<pre><code class="language-nix">{
  commit = {
    header = {
      length = 89;
      imperative = true;
      case = &quot;lower&quot;;
      invalidLastCharacters = &quot;.&quot;;
    };
    gpg = {
      required = false;
      identity = {
        gitHubOrganization = &quot;some-organization&quot;;
      };
    };
    conventional = {
      types = [
        &quot;type&quot;
      ];
      scopes = [
        &quot;scope&quot;
      ];
    };
  };
  license = {
    skipPaths = [
      &quot;.git/&quot;
      &quot;build*/&quot;
    ];
    allowPrecedingComments = false;
  };
}
</code></pre>
<p>This would produce the following <code>.conform.yaml</code> file:</p>
<pre><code class="language-yaml">policies:
  - spec:
      conventional:
        scopes:
          - scope
        types:
          - type
      gpg:
        identity:
          gitHubOrganization: some-organization
        required: false
      header:
        case: lower
        imperative: true
        invalidLastCharacters: .
        length: 89
    type: commit
  - spec:
      allowPrecedingComments: false
      skipPaths:
        - .git/
        - build*/
    type: license
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-settings"><a class="header" href="#github-settings">Github Settings</a></h1>
<p>This extension generates the <code>.github/settings.yml</code> file used by the <a href="https://github.com/probot/settings">Settings
App</a>.</p>
<h2 id="usage-1"><a class="header" href="#usage-1">Usage</a></h2>
<p>The schema for the configuration file is <a href="https://github.com/probot/settings#usage">detailed here</a>. For example:</p>
<pre><code class="language-nix">{
  configData = {
    repository = {
      name = &quot;repo-name&quot;;
      description = &quot;description of repo&quot;;
      homepage = &quot;https://example.github.io/&quot;;
      private = false;
    };
    labels = [
      {
        name = &quot;bug&quot;;
        color = &quot;CC0000&quot;;
        description = &quot;An issue with the system&quot;;
      }
      {
        name = &quot;feature&quot;;
        color = &quot;#336699&quot;;
        description = &quot;New functionality&quot;;
      }
    ];
    milestones = [
      {
        title = &quot;milestone-title&quot;;
        description = &quot;milestone-description&quot;;
        state = &quot;open&quot;;
      }
    ];
  };
}
</code></pre>
<p>Produces the following <code>.github/settings.yml</code>:</p>
<pre><code class="language-yaml">labels:
  - color: CC0000
    description: An issue with the system
    name: bug
  - color: &quot;#336699&quot;
    description: New functionality
    name: feature
milestones:
  - description: milestone-description
    state: open
    title: milestone-title
repository:
  description: description of repo
  homepage: https://example.github.io/
  name: repo-name
  private: false
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="just"><a class="header" href="#just">Just</a></h1>
<p>This extension generates the <code>.just</code> file used by the <a href="https://github.com/casey/just">Just</a> task runner. It
allows the creation of a <code>.justfile</code> by specifying a header and tasks:</p>
<h2 id="usage-2"><a class="header" href="#usage-2">Usage</a></h2>
<pre><code class="language-nix">{
  head = ''
    var := &quot;value&quot;
  '';
  tasks = {
    task1 = [
      ''echo &quot;Doing the thing&quot;''
      &quot;@doThing&quot;
    ];
  };
}
</code></pre>
<p>The configuration has two major sections. The first is the <code>head</code> field, a raw
string prepended to the top of the file. This section is typically where global
settings and variables are defined in the Justfile. The second is the <code>tasks</code>
field, a map of task names to a list of their respective steps. Each step in the
list should ideally encompass a single action (this is idiomatic for Justfiles);
however, multiline strings will also work.</p>
<p>The above example will produce the following file contents:</p>
<pre><code class="language-just">var := &quot;value&quot;

task1:
    echo &quot;Doing the thing&quot;
    @doThing
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lefthook"><a class="header" href="#lefthook">Lefthook</a></h1>
<p>This extension generates the <code>lefthook.yml</code> file for configuring <a href="https://github.com/evilmartians/lefthook">Lefthook</a>.</p>
<h2 id="usage-3"><a class="header" href="#usage-3">Usage</a></h2>
<pre><code class="language-nix">{
    configData = {
        commit-msg = {
            scripts = {
                template_checker = { runner = &quot;bash&quot;; };
            };
        };
        pre-commit = {
            commands = {
                stylelint = {
                    tags = &quot;frontend style&quot;;
                    glob = &quot;*.js&quot;;
                    run = &quot;yarn stylelint {staged_files}&quot;;
                };
                rubocop = {
                    tags = &quot;backend style&quot;;
                    glob = &quot;*.rb&quot;;
                    exclude = &quot;application.rb|routes.rb&quot;;
                    run = &quot;bundle exec rubocop --force-exclusion {all_files}&quot;;
                };
            };
            scripts = {
                &quot;good_job.js&quot; = { runner = &quot;node&quot;; };
            };
        };
    };
}
</code></pre>
<p>Produces the following <code>lefthook.yml</code>:</p>
<pre><code class="language-yaml">commit-msg:
  scripts:
    template_checker:
      runner: bash
pre-commit:
  commands:
    rubocop:
      exclude: application.rb|routes.rb
      glob: &quot;*.rb&quot;
      run: bundle exec rubocop --force-exclusion {all_files}
      tags: backend style
    stylelint:
      glob: &quot;*.js&quot;
      run: yarn stylelint {staged_files}
      tags: frontend style
  scripts:
    good_job.js:
      runner: node
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pre-commit"><a class="header" href="#pre-commit">Pre-commit</a></h1>
<p>This extension generates the <code>.pre-commit-config.yaml</code> file used to configure
<a href="https://pre-commit.com/">pre-commit</a>.</p>
<h2 id="usage-4"><a class="header" href="#usage-4">Usage</a></h2>
<p>The extension accepts a simplified configuration format that significantly
reduces the verbosity. When managing pre-commit with Nix, creating a single
&quot;local&quot; repo entry and adding system hooks that call out to binaries in the Nix
store is often desirable. The benefit of this approach is that Nix manages the
versioning of the binaries, and you have greater control over how the hook
operates.</p>
<p>The accepted format is as follows:</p>
<pre><code class="language-nix">{
    nixpkgs-fmt = {
        entry = &quot;${pkgs.nixpkgs-fmt}/bin/nixpkgs-fmt&quot;;
        language = &quot;system&quot;;
        files = &quot;\\.nix&quot;;
    }
}
</code></pre>
<p>The format is a set consisting of hook names as the keys and their configuration
properties as values. The <code>id</code> and <code>name</code> fields of the hook configuration are
set to the hook name (i.e., <code>nixpkgs-fmt</code>). The <code>entry</code> should point to the
binary called by pre-commit. Setting <code>language</code> to &quot;system&quot; ensures that the
<code>entry</code> is called with the default shell. Finally, setting <code>files</code> ensures that
pre-commit only passes Nix files to this hook. The above configuration would
produce the following <code>pre-commit-config.yaml</code> file:</p>
<pre><code class="language-yaml">repos:
  - hooks:
      - entry: /nix/store/pmfl7q4fqqibkfz71lsrkcdi04m0mclf-nixpkgs-fmt-1.2.0/bin/nixpkgs-fmt
        files: \.nix
        id: nixpkgs-fmt
        language: system
        name: nixpkgs-fmt
    repo: local
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prettier"><a class="header" href="#prettier">Prettier</a></h1>
<p>This plugin generates the <code>.prettierrc.json</code> file for configuring <a href="https://prettier.io/">Prettier</a>.
It provides two types: one that allows you to configure any <a href="https://prettier.io/docs/en/options.html">valid API
options</a> and another for generating an ignore file.</p>
<h2 id="usage-5"><a class="header" href="#usage-5">Usage</a></h2>
<p>The schema for the configuration file is <a href="https://prettier.io/docs/en/configuration.html">detailed here</a>. For example:</p>
<pre><code class="language-nix">{
    config = {
      arrowParens = &quot;always&quot;;
      bracketSpacing = true;
      tabWidth = 80;
    };
}
</code></pre>
<p>Produces the following <code>.prettierrc.json</code>:</p>
<pre><code class="language-json">{
  &quot;arrowParens&quot;: &quot;always&quot;,
  &quot;bracketSpacing&quot;: true,
  &quot;tabWidth&quot;: 80
}
</code></pre>
<h3 id="ignore-type"><a class="header" href="#ignore-type">Ignore type</a></h3>
<p>The extension can also be configured to accept a list of glob patterns used to
determine which files are excluded when <code>prettier</code> is run:</p>
<pre><code class="language-nix">{
  [
    &quot;.direnv&quot;
    &quot;.conform.yaml&quot;
    &quot;.prettierrc.json&quot;
    &quot;tests&quot;
    &quot;CHANGELOG.md&quot;
    &quot;lefthook.yml&quot;
  ]
}
</code></pre>
<p>When calling the extension, change the type to <code>ignore</code>:</p>
<pre><code class="language-nix">exts.prettier { configData = []; type = &quot;ignore&quot;; }
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="mermaid.min.js"></script>
        <script type="text/javascript" src="mermaid-init.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
